<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Registration Page</title>
    <link rel="stylesheet" href="login_and_reg-style.css" />
    <!-- Font Awesome CDN -->
    <script src="https://kit.fontawesome.com/3f53ec2c2f.js"></script>
  </head>
  <body>
    <div class="container">
      <div class="header">
        <h2>REGISTRATION FORM</h2>
      </div>
      <form class="form" id="form">
        <div class="form-control">
          <label>Username</label>
          <input
            type="text"
            name=""
            id="username"
            placeholder="Enter Your fullname"
            autocomplete="off"
          />
          <i class="fas fa-check-circle"></i>
          <i class="fas fa-exclamation-circle"></i>
          <small>Error Msg</small>
        </div>
        <div class="form-control">
          <label>Email</label>
          <input
            type="email"
            name=""
            id="email"
            placeholder="Enter Your email"
            autocomplete="off"
          />
          <i class="fas fa-check-circle"></i>
          <i class="fas fa-exclamation-circle"></i>
          <small>Error Msg</small>
        </div>
        <div class="form-control">
          <label>Phone Number</label>
          <input
            type="number"
            name=""
            id="phone"
            placeholder="Enter Your phone number"
            autocomplete="off"
          />
          <i class="fas fa-check-circle"></i>
          <i class="fas fa-exclamation-circle"></i>
          <small>Error Msg</small>
        </div>
        <div class="form-control">
          <label>Password</label>
          <input
            type="password"
            name=""
            id="password"
            placeholder="Enter Your password"
          />
          <i class="fas fa-check-circle"></i>
          <i class="fas fa-exclamation-circle"></i>
          <small>Error Msg</small>
        </div>
        <div class="form-control">
          <label>Confirm Password</label>
          <input
            type="password"
            name=""
            id="cpassword"
            placeholder="Confirm the Password"
          />
          <i class="fas fa-check-circle"></i>
          <i class="fas fa-exclamation-circle"></i>
          <small>Error Msg</small>
        </div>
        <input type="submit" value="Submit" class="btn" name=" " />
        <a href="./login.html">Already have an acoount</a>
      </form>
    </div>

    <!-- JavaScrip for Validation -->
    <script type="text/javascript">
      const form = document.getElementById("form");
      const username = document.getElementById("username");
      const email = document.getElementById("email");
      const phone = document.getElementById("phone");
      const password = document.getElementById("password");
      const cpassword = document.getElementById("cpassword");

      //add event
      form.addEventListener("submit", (event) => {
        event.preventDefault();
        validate();
      });

      const sendData = (sRate, count) => {
        if (sRate === count) {
          alert("registration successfull");
          location.href = `../index.html`;
        }
      };

      //for final data validation
      const successMsg = () => {
        let formCon = document.getElementsByClassName("form-control");
        var count = formCon.length - 1;
        for (var i = 0; i < formCon.length; i++) {
          if (formCon[i].className === "form-control success") {
            var sRate = 0 + i;
            console.log(sRate);
            sendData(sRate, count);
          } else {
            return false;
          }
        }
      };
      // more email validation
      const isEmail = (emailVal) => {
        var atSymbol = emailVal.indexOf("@");
        if (atSymbol < 1) return false;
        var dot = emailVal.lastIndexOf(".");
        if (dot <= atSymbol + 3) return false;
        if (dot === emailVal.length - 1) return false;
        return true;
      };
      //define the validate function
      const validate = () => {
        const usernameVal = username.value.trim();
        const emailVal = email.value.trim();
        const phoneVal = phone.value.trim();
        const passwordVal = password.value.trim();
        const cpasswordVal = cpassword.value.trim();

        // validate username
        if (usernameVal === "") {
          setErrormsg(username, "username cannot be blank");
        } else if (usernameVal.length <= 2) {
          setErrormsg(username, "username min 3 char");
        } else {
          setSuccessMsg(username);
        }
        // validate email
        if (emailVal === "") {
          setErrormsg(email, "email cannot be blank");
        } else if (!isEmail(emailVal)) {
          setErrormsg(email, "Not a valid Email");
        } else {
          setSuccessMsg(email);
        }
        // validate phone
        if (phoneVal === "") {
          setErrormsg(phone, "phone number cannot be blank");
        } else if (phoneVal.length != 10) {
          setErrormsg(phone, "Not a valid Phone no");
        } else {
          setSuccessMsg(phone);
        }
        // validate password
        if (passwordVal === "") {
          setErrormsg(password, "password cannot be blank");
        } else if (passwordVal.length <= 5) {
          setErrormsg(password, "Minimum 6 char");
        } else {
          setSuccessMsg(password);
        }
        // validate cpassword
        if (cpasswordVal === "") {
          setErrormsg(cpassword, "password cannot be blank");
        } else if (passwordVal != cpasswordVal) {
          setErrormsg(cpassword, "Password doen't match");
        } else {
          setSuccessMsg(cpassword);
        }
        successMsg();
      };
      function setErrormsg(input, errormsgs) {
        const formControl = input.parentElement;
        const small = formControl.querySelector("small");
        formControl.className = "form-control  error";
        small.innerText = errormsgs;
      }
      function setSuccessMsg(input) {
        const formControl = input.parentElement;
        formControl.className = "form-control success";
      }
    </script>
  </body>
</html>
